<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>&lt;span class=&#39;site-name&#39;&gt;Social Science Sofa | &lt;/span&gt; &lt;span class=&#39;logo-text&#39;&gt;[___]&lt;/span&gt;</title>
<link>https://thesocialsciencesofa.com/</link>
<atom:link href="https://thesocialsciencesofa.com/index.xml" rel="self" type="application/rss+xml"/>
<description>The Social Science Sofa is your cosy corner for data visualisation, R programming, and research insights—where complex ideas recline into clarity.</description>
<generator>quarto-1.4.549</generator>
<lastBuildDate>Sun, 29 Jun 2025 23:00:00 GMT</lastBuildDate>
<item>
  <title>Taming Multi-Dimensional Tables with gt</title>
  <dc:creator>Daniel Dauber</dc:creator>
  <link>https://thesocialsciencesofa.com/blog/2025-06-30/multi-dimensional-gt-tables-r.html</link>
  <description><![CDATA[ 
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&amp;family=Fredoka:wght@300..700&amp;family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&amp;family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&amp;family=Quicksand:wght@300..700&amp;family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&amp;display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">





<div class="slide-in">
<p><img src="https://thesocialsciencesofa.com/blog/2025-06-30/multi-dimensional-gt-tables-r.jpg" alt="MPG vs weight plot" width="100%"></p>
</div>
<p>Creating beautiful tables in R has never been easier thanks to the <a href="https://gt.rstudio.com/"><code>gt</code> package</a>. But what happens when your “simple” table suddenly needs three dimensions? That’s when things get interesting – and by interesting, I mean frustratingly complex.</p>
<p>Today, we’ll walk through creating a multi-dimensional table that displays relationship status by gender across different countries. We’ll start simple and work our way up to the challenges that make you question your life choices (and then solve them, of course).</p>
<section id="meet-the-gt-package" class="level2">
<h2 class="anchored" data-anchor-id="meet-the-gt-package">Meet the GT Package</h2>
<p>The <a href="https://gt.rstudio.com/"><code>gt</code> package</a> by RStudio is a grammar of tables that makes creating publication-ready tables surprisingly enjoyable. Think of it as <code>ggplot2</code> for tables – it’s structured, flexible, and produces gorgeous output with relatively little code.</p>
<p>The package follows a layered approach: you start with your data, create a basic <code>gt()</code> object, then add layers of formatting, styling, and functionality. Each function adds a specific element to your table, making the code readable and the process intuitive.</p>
<p>If you’re new to R or finding this tutorial challenging to follow, I’d recommend checking out <a href="https://r4np.com">R for Non-Programmers</a> for a more gentle introduction to R fundamentals.</p>
</section>
<section id="our-data-world-values-survey" class="level2">
<h2 class="anchored" data-anchor-id="our-data-world-values-survey">Our Data: World Values Survey</h2>
<p>We’ll be working with data from the World Values Survey (WVS), which contains responses from people across different countries about their values and demographics. The <code>wvs_nona</code> dataset is a cleaned version where missing values have been removed (hence “nona” = no NAs).</p>
<p>If you want to follow along, you can get the dataset from the <a href="https://github.com/yourrepo/r4np"><code>r4np</code> package</a>:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install if you haven't already</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("r4np")</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gt)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gtExtras)</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(r4np)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The dataset we'll use</span></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(wvs_nona)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  country gender   age relationship_status freedom_of_choice satisfaction
  &lt;fct&gt;   &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;                           &lt;dbl&gt;        &lt;dbl&gt;
1 Bolivia male      60 married                             7            5
2 Bolivia male      40 married                             8            7
3 Bolivia male      25 single                             10            8
4 Bolivia female    71 widowed                             5            5
5 Bolivia female    38 married                             5            7
6 Bolivia female    20 separated                           5            3</code></pre>
</div>
</div>
<p>Our goal is to create a table showing the relationship between three variables: <code>country</code>, <code>gender</code>, and <code>relationship_status</code>. This is what makes it “multi-dimensional” – we’re not just showing a simple two-way relationship, but a three-way interaction.</p>
</section>
<section id="step-1-the-innocent-beginning" class="level2">
<h2 class="anchored" data-anchor-id="step-1-the-innocent-beginning">Step 1: The Innocent Beginning</h2>
<p>Let’s start with what seems like a straightforward task: create a table showing the count of married, separated, and divorced people by gender across countries.</p>
<p>First, we need to count the combinations of our three variables:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create our base data</span></span>
<span id="cb5-2">table_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wvs_nona <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(gender, country, relationship_status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(relationship_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span>))</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Take a peek</span></span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(table_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  gender country relationship_status     n
  &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt;               &lt;int&gt;
1 female Bolivia married               383
2 female Bolivia separated              62
3 female Bolivia divorced               27
4 female Iran    married               448
5 female Iran    separated               4
6 female Iran    divorced               24</code></pre>
</div>
</div>
<p>The <code>count()</code> function is doing the heavy lifting here. It groups by the three variables we specify and counts how many observations fall into each combination. The <code>filter()</code> step narrows our focus to just three relationship statuses – we’re keeping the analysis manageable.</p>
<p>This gives us a “long” format dataset where each row represents one combination of country, gender, and relationship status, with the count in the <code>n</code> column.</p>
<p>Now we need to reshape this data to make it suitable for a table. We want countries as rows and the gender-relationship combinations as columns:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape for table format</span></span>
<span id="cb7-2">wide_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> table_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> country,</span>
<span id="cb7-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gender, relationship_status),</span>
<span id="cb7-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> n)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(wide_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  country female_married female_separated female_divorced male_married
  &lt;fct&gt;            &lt;int&gt;            &lt;int&gt;           &lt;int&gt;        &lt;int&gt;
1 Bolivia            383               62              27          376
2 Iran               448                4              24          518
3 Iraq               442                6              10          423
4 Japan              525                4              49          464
5 Korea              491                1               1          407
6 Egypt              399               10              23          434
# ℹ 2 more variables: male_separated &lt;int&gt;, male_divorced &lt;int&gt;</code></pre>
</div>
</div>
<p><code>pivot_wider()</code> is the magic function here. Let’s break down what each argument does:</p>
<ul>
<li><code>id_cols = country</code>: This tells R that <code>country</code> should remain as a column (our row identifier)</li>
<li><code>names_from = c(gender, relationship_status)</code>: These two variables will become column names</li>
<li><code>values_from = n</code>: The values that fill the table come from the <code>n</code> column (our counts)</li>
</ul>
<p>The result is columns with names like <code>female_married</code>, <code>male_divorced</code>, etc. R automatically combines the values from <code>gender</code> and <code>relationship_status</code> with an underscore.</p>
<p>Now let’s create our first GT table:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our first attempt</span></span>
<span id="cb9-2">basic_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wide_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb9-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Value Survey (WVS)"</span>,</span>
<span id="cb9-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relationship Status by Gender and Country"</span></span>
<span id="cb9-7">  )</span>
<span id="cb9-8"></span>
<span id="cb9-9">basic_table</span></code></pre></div>
<div class="cell-output-display">
<div id="ualuxbdyfa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ualuxbdyfa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ualuxbdyfa thead, #ualuxbdyfa tbody, #ualuxbdyfa tfoot, #ualuxbdyfa tr, #ualuxbdyfa td, #ualuxbdyfa th {
  border-style: none;
}

#ualuxbdyfa p {
  margin: 0;
  padding: 0;
}

#ualuxbdyfa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ualuxbdyfa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ualuxbdyfa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ualuxbdyfa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ualuxbdyfa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ualuxbdyfa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualuxbdyfa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ualuxbdyfa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ualuxbdyfa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ualuxbdyfa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ualuxbdyfa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ualuxbdyfa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ualuxbdyfa .gt_spanner_row {
  border-bottom-style: hidden;
}

#ualuxbdyfa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ualuxbdyfa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ualuxbdyfa .gt_from_md > :first-child {
  margin-top: 0;
}

#ualuxbdyfa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ualuxbdyfa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ualuxbdyfa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ualuxbdyfa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ualuxbdyfa .gt_row_group_first td {
  border-top-width: 2px;
}

#ualuxbdyfa .gt_row_group_first th {
  border-top-width: 2px;
}

#ualuxbdyfa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualuxbdyfa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ualuxbdyfa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ualuxbdyfa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualuxbdyfa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualuxbdyfa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ualuxbdyfa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ualuxbdyfa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ualuxbdyfa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ualuxbdyfa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ualuxbdyfa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualuxbdyfa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ualuxbdyfa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ualuxbdyfa .gt_left {
  text-align: left;
}

#ualuxbdyfa .gt_center {
  text-align: center;
}

#ualuxbdyfa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ualuxbdyfa .gt_font_normal {
  font-weight: normal;
}

#ualuxbdyfa .gt_font_bold {
  font-weight: bold;
}

#ualuxbdyfa .gt_font_italic {
  font-style: italic;
}

#ualuxbdyfa .gt_super {
  font-size: 65%;
}

#ualuxbdyfa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ualuxbdyfa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ualuxbdyfa .gt_indent_1 {
  text-indent: 5px;
}

#ualuxbdyfa .gt_indent_2 {
  text-indent: 10px;
}

#ualuxbdyfa .gt_indent_3 {
  text-indent: 15px;
}

#ualuxbdyfa .gt_indent_4 {
  text-indent: 20px;
}

#ualuxbdyfa .gt_indent_5 {
  text-indent: 25px;
}

#ualuxbdyfa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ualuxbdyfa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal">World Value Survey (WVS)</th>
</tr>
<tr class="odd gt_heading">
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Relationship Status by Gender and Country</th>
</tr>
<tr class="header gt_col_headings">
<th id="country" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">country</th>
<th id="female_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">female_married</th>
<th id="female_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">female_separated</th>
<th id="female_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">female_divorced</th>
<th id="male_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">male_married</th>
<th id="male_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">male_separated</th>
<th id="male_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">male_divorced</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="country">Bolivia</td>
<td class="gt_row gt_right" headers="female_married">383</td>
<td class="gt_row gt_right" headers="female_separated">62</td>
<td class="gt_row gt_right" headers="female_divorced">27</td>
<td class="gt_row gt_right" headers="male_married">376</td>
<td class="gt_row gt_right" headers="male_separated">34</td>
<td class="gt_row gt_right" headers="male_divorced">24</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Iran</td>
<td class="gt_row gt_right" headers="female_married">448</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">24</td>
<td class="gt_row gt_right" headers="male_married">518</td>
<td class="gt_row gt_right" headers="male_separated">8</td>
<td class="gt_row gt_right" headers="male_divorced">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Iraq</td>
<td class="gt_row gt_right" headers="female_married">442</td>
<td class="gt_row gt_right" headers="female_separated">6</td>
<td class="gt_row gt_right" headers="female_divorced">10</td>
<td class="gt_row gt_right" headers="male_married">423</td>
<td class="gt_row gt_right" headers="male_separated">5</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Japan</td>
<td class="gt_row gt_right" headers="female_married">525</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">49</td>
<td class="gt_row gt_right" headers="male_married">464</td>
<td class="gt_row gt_right" headers="male_separated">1</td>
<td class="gt_row gt_right" headers="male_divorced">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Korea</td>
<td class="gt_row gt_right" headers="female_married">491</td>
<td class="gt_row gt_right" headers="female_separated">1</td>
<td class="gt_row gt_right" headers="female_divorced">1</td>
<td class="gt_row gt_right" headers="male_married">407</td>
<td class="gt_row gt_right" headers="male_separated">NA</td>
<td class="gt_row gt_right" headers="male_divorced">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Egypt</td>
<td class="gt_row gt_right" headers="female_married">399</td>
<td class="gt_row gt_right" headers="female_separated">10</td>
<td class="gt_row gt_right" headers="female_divorced">23</td>
<td class="gt_row gt_right" headers="male_married">434</td>
<td class="gt_row gt_right" headers="male_separated">7</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>gt()</code> function creates the basic table object, and <code>tab_header()</code> adds a title and subtitle. Simple enough, but not very pretty.</p>
</section>
<section id="step-2-the-plot-thickens" class="level2">
<h2 class="anchored" data-anchor-id="step-2-the-plot-thickens">Step 2: The Plot Thickens</h2>
<p>Our basic table works, but it’s not exactly reader-friendly. Those column names like <code>female_married</code> are functional but ugly. We want to group them under gender headers with clean sub-labels.</p>
<p>“No problem,” you think, “I’ll just use <code>tab_spanner_delim()</code>!”</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Attempt with tab_spanner_delim()</span></span>
<span id="cb10-2">spanners_attempt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wide_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb10-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Value Survey (WVS)"</span>,</span>
<span id="cb10-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Relationship Status by Gender and Country"</span>  </span>
<span id="cb10-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner_delim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>)</span>
<span id="cb10-9"></span>
<span id="cb10-10">spanners_attempt</span></code></pre></div>
<div class="cell-output-display">
<div id="nwmojxwmez" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nwmojxwmez table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nwmojxwmez thead, #nwmojxwmez tbody, #nwmojxwmez tfoot, #nwmojxwmez tr, #nwmojxwmez td, #nwmojxwmez th {
  border-style: none;
}

#nwmojxwmez p {
  margin: 0;
  padding: 0;
}

#nwmojxwmez .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nwmojxwmez .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nwmojxwmez .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nwmojxwmez .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nwmojxwmez .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwmojxwmez .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwmojxwmez .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nwmojxwmez .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nwmojxwmez .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nwmojxwmez .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nwmojxwmez .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nwmojxwmez .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nwmojxwmez .gt_spanner_row {
  border-bottom-style: hidden;
}

#nwmojxwmez .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nwmojxwmez .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nwmojxwmez .gt_from_md > :first-child {
  margin-top: 0;
}

#nwmojxwmez .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nwmojxwmez .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nwmojxwmez .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nwmojxwmez .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nwmojxwmez .gt_row_group_first td {
  border-top-width: 2px;
}

#nwmojxwmez .gt_row_group_first th {
  border-top-width: 2px;
}

#nwmojxwmez .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwmojxwmez .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nwmojxwmez .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nwmojxwmez .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwmojxwmez .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwmojxwmez .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nwmojxwmez .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nwmojxwmez .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nwmojxwmez .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nwmojxwmez .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwmojxwmez .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwmojxwmez .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nwmojxwmez .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nwmojxwmez .gt_left {
  text-align: left;
}

#nwmojxwmez .gt_center {
  text-align: center;
}

#nwmojxwmez .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nwmojxwmez .gt_font_normal {
  font-weight: normal;
}

#nwmojxwmez .gt_font_bold {
  font-weight: bold;
}

#nwmojxwmez .gt_font_italic {
  font-style: italic;
}

#nwmojxwmez .gt_super {
  font-size: 65%;
}

#nwmojxwmez .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nwmojxwmez .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nwmojxwmez .gt_indent_1 {
  text-indent: 5px;
}

#nwmojxwmez .gt_indent_2 {
  text-indent: 10px;
}

#nwmojxwmez .gt_indent_3 {
  text-indent: 15px;
}

#nwmojxwmez .gt_indent_4 {
  text-indent: 20px;
}

#nwmojxwmez .gt_indent_5 {
  text-indent: 25px;
}

#nwmojxwmez .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nwmojxwmez div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal">World Value Survey (WVS)</th>
</tr>
<tr class="odd gt_heading">
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Relationship Status by Gender and Country</th>
</tr>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="country" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">country</th>
<th colspan="3" id="spanner-female_married" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
female
</div></th>
<th colspan="3" id="spanner-male_married" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
male
</div></th>
</tr>
<tr class="odd gt_col_headings">
<th id="female_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">married</th>
<th id="female_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">separated</th>
<th id="female_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">divorced</th>
<th id="male_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">married</th>
<th id="male_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">separated</th>
<th id="male_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">divorced</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="country">Bolivia</td>
<td class="gt_row gt_right" headers="female_married">383</td>
<td class="gt_row gt_right" headers="female_separated">62</td>
<td class="gt_row gt_right" headers="female_divorced">27</td>
<td class="gt_row gt_right" headers="male_married">376</td>
<td class="gt_row gt_right" headers="male_separated">34</td>
<td class="gt_row gt_right" headers="male_divorced">24</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Iran</td>
<td class="gt_row gt_right" headers="female_married">448</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">24</td>
<td class="gt_row gt_right" headers="male_married">518</td>
<td class="gt_row gt_right" headers="male_separated">8</td>
<td class="gt_row gt_right" headers="male_divorced">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Iraq</td>
<td class="gt_row gt_right" headers="female_married">442</td>
<td class="gt_row gt_right" headers="female_separated">6</td>
<td class="gt_row gt_right" headers="female_divorced">10</td>
<td class="gt_row gt_right" headers="male_married">423</td>
<td class="gt_row gt_right" headers="male_separated">5</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Japan</td>
<td class="gt_row gt_right" headers="female_married">525</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">49</td>
<td class="gt_row gt_right" headers="male_married">464</td>
<td class="gt_row gt_right" headers="male_separated">1</td>
<td class="gt_row gt_right" headers="male_divorced">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Korea</td>
<td class="gt_row gt_right" headers="female_married">491</td>
<td class="gt_row gt_right" headers="female_separated">1</td>
<td class="gt_row gt_right" headers="female_divorced">1</td>
<td class="gt_row gt_right" headers="male_married">407</td>
<td class="gt_row gt_right" headers="male_separated">NA</td>
<td class="gt_row gt_right" headers="male_divorced">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Egypt</td>
<td class="gt_row gt_right" headers="female_married">399</td>
<td class="gt_row gt_right" headers="female_separated">10</td>
<td class="gt_row gt_right" headers="female_divorced">23</td>
<td class="gt_row gt_right" headers="male_married">434</td>
<td class="gt_row gt_right" headers="male_separated">7</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>tab_spanner_delim()</code> is GT’s convenient function for automatically creating column groups. It looks at your column names, splits them at the delimiter you specify (in this case, the underscore), and creates grouped headers.</p>
<p>This creates the gender groupings automatically by splitting on the underscore. The part before the underscore becomes the group header (“female”, “male”), and the part after becomes the column label (“married”, “separated”, “divorced”).</p>
<p>It’s clean, it’s automatic, and it… doesn’t let you customise the subcategory labels. You’re stuck with “married”, “separated”, “divorced” exactly as they appear in your column names.</p>
<p>What if you want “Married” (capitalised), “Sep.” (abbreviated), or “Divorced/Separated” (combined)? What if you want to style them with bold or italic text? <code>tab_spanner_delim()</code> just shrugs and says “take it or leave it.”</p>
</section>
<section id="step-3-the-manual-labor-solution" class="level2">
<h2 class="anchored" data-anchor-id="step-3-the-manual-labor-solution">Step 3: The Manual Labor Solution</h2>
<p>This is where GT shows both its power and its complexity. To get full control, we need to manually create our spanners and relabel our columns. It’s more work, but it’s infinitely more flexible.</p>
<p>Let’s break this down step by step:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The manual approach - more control, more code</span></span>
<span id="cb11-2">custom_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wide_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb11-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Value Survey (WVS)"</span>,</span>
<span id="cb11-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data extract from r4np"</span></span>
<span id="cb11-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-8">  </span>
<span id="cb11-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Create individual gender spanners</span></span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb11-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*female*"</span>),</span>
<span id="cb11-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>)</span>
<span id="cb11-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb11-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*male*"</span>), </span>
<span id="cb11-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male_"</span>)</span>
<span id="cb11-17">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-18">  </span>
<span id="cb11-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Create an overarching gender spanner</span></span>
<span id="cb11-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb11-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Gender**"</span>),</span>
<span id="cb11-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male_"</span>)),</span>
<span id="cb11-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb11-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-25">  </span>
<span id="cb11-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Customise individual column labels</span></span>
<span id="cb11-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(</span>
<span id="cb11-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Country**"</span>),</span>
<span id="cb11-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Married"</span>,</span>
<span id="cb11-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Separated"</span>, </span>
<span id="cb11-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Divorced"</span></span>
<span id="cb11-32">  )</span>
<span id="cb11-33"></span>
<span id="cb11-34">custom_table</span></code></pre></div>
<div class="cell-output-display">
<div id="obbnoaphed" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#obbnoaphed table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#obbnoaphed thead, #obbnoaphed tbody, #obbnoaphed tfoot, #obbnoaphed tr, #obbnoaphed td, #obbnoaphed th {
  border-style: none;
}

#obbnoaphed p {
  margin: 0;
  padding: 0;
}

#obbnoaphed .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#obbnoaphed .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#obbnoaphed .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#obbnoaphed .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#obbnoaphed .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#obbnoaphed .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obbnoaphed .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#obbnoaphed .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#obbnoaphed .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#obbnoaphed .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#obbnoaphed .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#obbnoaphed .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#obbnoaphed .gt_spanner_row {
  border-bottom-style: hidden;
}

#obbnoaphed .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#obbnoaphed .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#obbnoaphed .gt_from_md > :first-child {
  margin-top: 0;
}

#obbnoaphed .gt_from_md > :last-child {
  margin-bottom: 0;
}

#obbnoaphed .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#obbnoaphed .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#obbnoaphed .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#obbnoaphed .gt_row_group_first td {
  border-top-width: 2px;
}

#obbnoaphed .gt_row_group_first th {
  border-top-width: 2px;
}

#obbnoaphed .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#obbnoaphed .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#obbnoaphed .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#obbnoaphed .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obbnoaphed .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#obbnoaphed .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#obbnoaphed .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#obbnoaphed .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#obbnoaphed .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#obbnoaphed .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#obbnoaphed .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#obbnoaphed .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#obbnoaphed .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#obbnoaphed .gt_left {
  text-align: left;
}

#obbnoaphed .gt_center {
  text-align: center;
}

#obbnoaphed .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#obbnoaphed .gt_font_normal {
  font-weight: normal;
}

#obbnoaphed .gt_font_bold {
  font-weight: bold;
}

#obbnoaphed .gt_font_italic {
  font-style: italic;
}

#obbnoaphed .gt_super {
  font-size: 65%;
}

#obbnoaphed .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#obbnoaphed .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#obbnoaphed .gt_indent_1 {
  text-indent: 5px;
}

#obbnoaphed .gt_indent_2 {
  text-indent: 10px;
}

#obbnoaphed .gt_indent_3 {
  text-indent: 15px;
}

#obbnoaphed .gt_indent_4 {
  text-indent: 20px;
}

#obbnoaphed .gt_indent_5 {
  text-indent: 25px;
}

#obbnoaphed .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#obbnoaphed div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="7" class="gt_heading gt_title gt_font_normal">World Value Survey (WVS)</th>
</tr>
<tr class="odd gt_heading">
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Data extract from r4np</th>
</tr>
<tr class="header gt_col_headings gt_spanner_row">
<th class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="6" id="gender" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<strong>Gender</strong>
</div></th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="country" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Country</strong></th>
<th colspan="3" id="*female*" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<em>female</em>
</div></th>
<th colspan="3" id="*male*" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
<em>male</em>
</div></th>
</tr>
<tr class="header gt_col_headings">
<th id="female_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Married</th>
<th id="female_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Separated</th>
<th id="female_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Divorced</th>
<th id="male_married" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Married</th>
<th id="male_separated" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Separated</th>
<th id="male_divorced" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Divorced</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="country">Bolivia</td>
<td class="gt_row gt_right" headers="female_married">383</td>
<td class="gt_row gt_right" headers="female_separated">62</td>
<td class="gt_row gt_right" headers="female_divorced">27</td>
<td class="gt_row gt_right" headers="male_married">376</td>
<td class="gt_row gt_right" headers="male_separated">34</td>
<td class="gt_row gt_right" headers="male_divorced">24</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Iran</td>
<td class="gt_row gt_right" headers="female_married">448</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">24</td>
<td class="gt_row gt_right" headers="male_married">518</td>
<td class="gt_row gt_right" headers="male_separated">8</td>
<td class="gt_row gt_right" headers="male_divorced">6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Iraq</td>
<td class="gt_row gt_right" headers="female_married">442</td>
<td class="gt_row gt_right" headers="female_separated">6</td>
<td class="gt_row gt_right" headers="female_divorced">10</td>
<td class="gt_row gt_right" headers="male_married">423</td>
<td class="gt_row gt_right" headers="male_separated">5</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Japan</td>
<td class="gt_row gt_right" headers="female_married">525</td>
<td class="gt_row gt_right" headers="female_separated">4</td>
<td class="gt_row gt_right" headers="female_divorced">49</td>
<td class="gt_row gt_right" headers="male_married">464</td>
<td class="gt_row gt_right" headers="male_separated">1</td>
<td class="gt_row gt_right" headers="male_divorced">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="country">Korea</td>
<td class="gt_row gt_right" headers="female_married">491</td>
<td class="gt_row gt_right" headers="female_separated">1</td>
<td class="gt_row gt_right" headers="female_divorced">1</td>
<td class="gt_row gt_right" headers="male_married">407</td>
<td class="gt_row gt_right" headers="male_separated">NA</td>
<td class="gt_row gt_right" headers="male_divorced">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="country">Egypt</td>
<td class="gt_row gt_right" headers="female_married">399</td>
<td class="gt_row gt_right" headers="female_separated">10</td>
<td class="gt_row gt_right" headers="female_divorced">23</td>
<td class="gt_row gt_right" headers="male_married">434</td>
<td class="gt_row gt_right" headers="male_separated">7</td>
<td class="gt_row gt_right" headers="male_divorced">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s dissect what’s happening here:</p>
<p><strong>Step 1: Individual Gender Spanners</strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb12-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*female*"</span>),</span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>)</span>
<span id="cb12-4">)</span></code></pre></div>
</div>
<p>This creates a spanner (column group) labeled “female” that covers all columns starting with “female_”. The <code>md()</code> function allows us to use markdown formatting – in this case, italics with the asterisks.</p>
<p>The <code>starts_with()</code> function is a “tidy select” helper that selects columns based on their names. It’s much more reliable than typing out column names manually, especially when your column names follow a pattern.</p>
<p><strong>Step 2: Overarching Spanner</strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb13-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Gender**"</span>),</span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male_"</span>)),</span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb13-5">)</span></code></pre></div>
</div>
<p>This creates a higher-level spanner that encompasses both gender groups. The <code>columns</code> argument uses a vector of prefixes to select all columns that start with either “female_” or “male_”. The <code>id = "gender"</code> gives this spanner a unique identifier that we could reference later if needed.</p>
<p><strong>Step 3: Column Label Customisation</strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(</span>
<span id="cb14-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Country**"</span>),</span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Married"</span>,</span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Separated"</span>, </span>
<span id="cb14-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Divorced"</span></span>
<span id="cb14-6">)</span></code></pre></div>
</div>
<p>Here’s where the magic happens. <code>cols_label()</code> lets us rename columns, but it also supports conditional renaming using the <code>~</code> formula syntax.</p>
<ul>
<li><code>country = md("**Country**")</code>: Directly renames the country column</li>
<li><code>ends_with("married") ~ "Married"</code>: This says “for any column that ends with ‘married’, rename it to ‘Married’”</li>
</ul>
<p>This pattern-based renaming is incredibly powerful. Instead of writing:</p>
<div id="tbl-different-correlations" class="cell slide-in quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-different-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1
</figcaption>
<div aria-describedby="tbl-different-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code anchored" id="tbl-different-correlations" style="background: #f1f3f5;"><pre class="sourceCode r cell slide-in code-with-copy"><code class="sourceCode r"><span id="tbl-different-correlations-1">female_married <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Married"</span>,</span>
<span id="tbl-different-correlations-2">male_married <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Married"</span>,</span>
<span id="tbl-different-correlations-3">female_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Separated"</span>,</span>
<span id="tbl-different-correlations-4">male_separated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Separated"</span></span>
<span id="tbl-different-correlations-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ... and so on</span></span></code></pre></div>
</div>
</figure>
</div>
<p>We can use the formula syntax to apply the same transformation to multiple columns at once. The results is pretty respectable.</p>
</section>
<section id="step-4-the-na-problem-plot-twist" class="level2">
<h2 class="anchored" data-anchor-id="step-4-the-na-problem-plot-twist">Step 4: The NA Problem (Plot Twist!)</h2>
<p>But wait, there’s more! Let’s add a total column to show the sum across relationship statuses:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding totals - first attempt</span></span>
<span id="cb15-2">with_totals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wide_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(., <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>country))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ... rest of our formatting code</span></span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Total**"</span>))</span>
<span id="cb15-7"></span>
<span id="cb15-8">with_totals</span></code></pre></div>
</div>
<p>Let’s break down that <code>mutate()</code> line: - <code>select(., -country)</code>: Selects all columns except <code>country</code> (the <code>.</code> refers to the current data frame) - <code>rowSums()</code>: Sums across columns for each row - <code>mutate(total = ...)</code>: Creates a new column called <code>total</code> with these row sums</p>
<p>You might notice some countries have suspiciously low totals or <code>NA</code> values. That’s because <code>rowSums()</code> doesn’t handle <code>NA</code> values the way you might expect – if any value in a row is <code>NA</code>, the entire sum becomes <code>NA</code>.</p>
<p>In our case, <code>NA</code> in the count data doesn’t mean “missing information” – it means “zero observations for this combination.” For example, if a country has no divorced males in the survey, that cell will be <code>NA</code>, but for our table purposes, we want to treat it as zero.</p>
</section>
<section id="step-5-the-na-solution" class="level2">
<h2 class="anchored" data-anchor-id="step-5-the-na-solution">Step 5: The NA Solution</h2>
<p>Let’s fix the NA problem properly:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The NA fix</span></span>
<span id="cb16-2">clean_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wide_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace NA with 0 - this makes sense for count data</span></span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now rowSums will work properly</span></span>
<span id="cb16-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(., <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>country)))</span>
<span id="cb16-7"></span>
<span id="cb16-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(clean_data)</span></code></pre></div>
</div>
<p>This code introduces a powerful pattern:</p>
<p><strong><code>across()</code> for Multiple Column Operations</strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .)))</span></code></pre></div>
</div>
<p><code>across()</code> is a function that applies the same transformation to multiple columns. Let’s break it down:</p>
<ul>
<li><code>where(is.numeric)</code>: Selects columns based on a condition – in this case, all numeric columns</li>
<li><code>~ if_else(is.na(.), 0, .)</code>: This is a formula (notice the <code>~</code>) that defines the transformation
<ul>
<li><code>is.na(.)</code>: Checks if the value is NA (the <code>.</code> represents each value)</li>
<li><code>if_else(condition, true_value, false_value)</code>: If the value is NA, replace with 0, otherwise keep the original value</li>
</ul></li>
</ul>
<p>This is much more efficient than writing separate <code>mutate()</code> statements for each column, and it’s robust – if you add more numeric columns later, they’ll automatically be included in the transformation.</p>
</section>
<section id="step-6-the-full-solution-explained" class="level2">
<h2 class="anchored" data-anchor-id="step-6-the-full-solution-explained">Step 6: The Full Solution Explained</h2>
<p>Now let’s put it all together with detailed explanations and a little bit of flair:</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Our final, polished table</span></span>
<span id="cb18-2">final_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wvs_nona <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Create counts for each combination</span></span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(gender, country, relationship_status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-5">  </span>
<span id="cb18-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Filter to our relationship statuses of interest</span></span>
<span id="cb18-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(relationship_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-8">  </span>
<span id="cb18-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Reshape from long to wide format</span></span>
<span id="cb18-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> country,</span>
<span id="cb18-11">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(gender, relationship_status),</span>
<span id="cb18-12">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-13">  </span>
<span id="cb18-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4: Handle NAs properly for count data</span></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(.), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-16">  </span>
<span id="cb18-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 5: Add row totals</span></span>
<span id="cb18-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowSums</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(., <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>country))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-19">  </span>
<span id="cb18-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 6: Create the GT table</span></span>
<span id="cb18-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-22">  </span>
<span id="cb18-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 7: Add headers</span></span>
<span id="cb18-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_header</span>(</span>
<span id="cb18-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Value Survey (WVS)"</span>,</span>
<span id="cb18-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data extract from r4np"</span></span>
<span id="cb18-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-28">  </span>
<span id="cb18-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 8: Create nested column spanners</span></span>
<span id="cb18-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb18-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*female*"</span>),</span>
<span id="cb18-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>)</span>
<span id="cb18-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb18-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*male*"</span>),</span>
<span id="cb18-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male_"</span>)</span>
<span id="cb18-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_spanner</span>(</span>
<span id="cb18-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Gender**"</span>),</span>
<span id="cb18-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">columns =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male_"</span>)),</span>
<span id="cb18-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gender"</span></span>
<span id="cb18-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-43">  </span>
<span id="cb18-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 9: Customise column labels</span></span>
<span id="cb18-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols_label</span>(</span>
<span id="cb18-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Country**"</span>),</span>
<span id="cb18-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Total**"</span>),</span>
<span id="cb18-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"married"</span>,</span>
<span id="cb18-49">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"separated"</span>,</span>
<span id="cb18-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ends_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"divorced"</span></span>
<span id="cb18-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-52">  </span>
<span id="cb18-53">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 10: Add visual elements</span></span>
<span id="cb18-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_plt_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> total) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-55">  </span>
<span id="cb18-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 11: Add footer information</span></span>
<span id="cb18-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Source:**&lt;br&gt;*World Value Survey (2024)*"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-58">  </span>
<span id="cb18-59">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 12: Apply a theme</span></span>
<span id="cb18-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span>
<span id="cb18-61"></span>
<span id="cb18-62">final_table</span></code></pre></div>
</div>
<p>Admittedly, this code chunk is a lot more substantial than going with the standard <code>gt</code> table setup, but it certainly looks a lot more audience-ready and accessible</p>
<p>Let me explain the final formatting steps so you can apply those changes to your own tables as well:</p>
<p><strong>Visual Enhancement with <code>gt_plt_bar()</code></strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_plt_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">column =</span> total)</span></code></pre></div>
</div>
<p>This function from the <code>gtExtras</code> package adds mini bar charts to the total column. It automatically scales the bars based on the values in the column, making it easy to visually compare totals across countries. The bars appear within the table cells themselves.</p>
<p><strong>Footnotes for Attribution</strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tab_footnote</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">md</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Source: **&lt;br&gt;*World Value Survey (2024)*"</span>))</span></code></pre></div>
</div>
<p><code>tab_footnote()</code> adds a footnote to the table. The <code>&lt;br&gt;</code> is HTML for a line break, and again we’re using <code>md()</code> to enable markdown formatting for bold text and italics.</p>
<p><strong>Theming with <code>gt_theme_espn()</code></strong></p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</div>
<p>This applies a pre-built theme that mimics the ESPN sports network styling. The <code>gtExtras</code> package includes several pre-built themes that can dramatically change your table’s appearance with a single line of code. This is particularly helpful if you want to quickly apply a uniform style to all your tables in a presentation, report or publication.</p>
</section>
<section id="why-this-approach-works" class="level2">
<h2 class="anchored" data-anchor-id="why-this-approach-works">Why This Approach Works</h2>
<p>The manual approach we’ve taken here solves several problems:</p>
<ol type="1">
<li><strong>Flexibility</strong>: We can style each spanner and column label exactly how we want.</li>
<li><strong>Maintainability</strong>: The pattern-based selection (<code>starts_with()</code>, <code>ends_with()</code>) means our code will work even if column names change slightly.</li>
<li><strong>Scalability</strong>: If we add more countries or relationship statuses, most of the code will still work.</li>
<li><strong>Readability</strong>: Each step has a clear purpose and the code is self-documenting.</li>
</ol>
</section>
<section id="the-lessons-learned" class="level2">
<h2 class="anchored" data-anchor-id="the-lessons-learned">The Lessons Learned</h2>
<p>Creating multi-dimensional tables in <code>gt</code> teaches us several important concepts:</p>
<ol type="1">
<li><p><strong>Data shape matters</strong>: The structure of your data determines how easy it is to create your desired table. Sometimes reshaping is necessary.</p></li>
<li><p><strong>NA handling is context-dependent</strong>: In count data, NA often means zero, but in other contexts, it might mean something else entirely. Therefore, we might have to amend our table values as necessary.</p></li>
<li><p><strong>Pattern-based selection is powerful</strong>: Functions like <code>starts_with()</code>, <code>ends_with()</code>, and <code>where()</code> make your code more robust, concise and less prone to errors.</p></li>
<li><p><strong>The <code>~</code> formula syntax</strong>: This R feature appears in many places (<code>cols_label()</code>, <code>across()</code>, <code>ggplot2</code>) and is worth understanding deeply.</p></li>
<li><p><strong>Layered approach</strong>: <code>gt</code>’s philosophy of building tables layer by layer makes complex tables a lot more manageable.</p></li>
</ol>
<p>The GT package is incredibly powerful, but like any sophisticated tool, it rewards understanding its patterns and conventions. When your table needs go beyond the basics, don’t be afraid to break down the problem into smaller steps and build up your solution incrementally.</p>
</section>
<section id="want-to-learn-more" class="level2">
<h2 class="anchored" data-anchor-id="want-to-learn-more">Want to Learn More?</h2>
<ul>
<li><a href="https://gt.rstudio.com/">GT Package Documentation</a> - Comprehensive guide with examples</li>
<li><a href="https://jthomasmock.github.io/gtExtras/">GT Extras Package</a> - Additional functionality and themes</li>
<li><a href="https://r4np.com">R for Non-Programmers</a> - If you want to strengthen your R fundamentals</li>
</ul>
<p>The key to mastering <code>gt</code> (and R in general) is understanding the building blocks and how they combine. Once you grasp these patterns, you’ll find yourself creating publication-ready tables with confidence and in no time.</p>
<p>Happy table-making!</p>


</section>

 ]]></description>
  <category>R</category>
  <category>data visualisation</category>
  <category>gt</category>
  <category>tables</category>
  <guid>https://thesocialsciencesofa.com/blog/2025-06-30/multi-dimensional-gt-tables-r.html</guid>
  <pubDate>Sun, 29 Jun 2025 23:00:00 GMT</pubDate>
  <media:content url="https://thesocialsciencesofa.com/blog/2025-06-30/multi-dimensional-gt-tables-r.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Fourth Post</title>
  <dc:creator>Daniel Dauber</dc:creator>
  <link>https://thesocialsciencesofa.com/blog/2025-06-20/fourth_post.html</link>
  <description><![CDATA[ 
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&amp;family=Fredoka:wght@300..700&amp;family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&amp;family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&amp;family=Quicksand:wght@300..700&amp;family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&amp;display=swap" rel="stylesheet">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">





<div class="slide-in">
<p><img src="https://thesocialsciencesofa.com/blog/2025-06-20/image.jpg" alt="MPG vs weight plot" width="100%"></p>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">✍️ Introduction</h2>
<p>Welcome! This post is a demonstration of how a typical Quarto blog post might look.<br>
It includes headings, inline formatting, R code, a data visualisation, tables, and more.</p>
<p>Quarto allows you to write in markdown, embed live code, and include <strong>beautiful, reproducible outputs</strong> — all in one place.</p>
<p>Whether you’re documenting your research, writing tutorials, or just keeping notes, it gives you the flexibility of code and prose combined.</p>
</section>
<section id="lists" class="level2">
<h2 class="anchored" data-anchor-id="lists">📋 Lists</h2>
<section id="unordered-list" class="level3">
<h3 class="anchored" data-anchor-id="unordered-list">Unordered list</h3>
<ul>
<li>Quarto supports markdown out of the box<br>
</li>
<li>Code can be executed and rendered inline<br>
</li>
<li>You can embed LaTeX, HTML, or call external files</li>
</ul>
</section>
<section id="ordered-list" class="level3">
<h3 class="anchored" data-anchor-id="ordered-list">Ordered list</h3>
<ol type="1">
<li>Install R and RStudio<br>
</li>
<li>Install Quarto CLI<br>
</li>
<li>Start writing posts like this one</li>
</ol>
</section>
</section>
<section id="a-quote-for-good-measure" class="level2">
<h2 class="anchored" data-anchor-id="a-quote-for-good-measure">💬 A Quote for Good Measure</h2>
<blockquote class="blockquote">
<p>“A picture is worth a thousand words. A good plot is worth even more in R.”<br>
— You, after adopting Quarto</p>
</blockquote>
<hr>
</section>
<section id="r-code-and-visualisation" class="level2">
<h2 class="anchored" data-anchor-id="r-code-and-visualisation">📊 R Code and Visualisation</h2>
<p>Let’s explore a classic dataset in R: <code>mtcars</code>. Below is a simple scatter plot showing how miles per gallon (<code>mpg</code>) relates to car weight (<code>wt</code>).</p>
<div class="cell slide-in">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"></span>
<span id="cb1-3">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> mpg)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0072B2"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb1-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MPG vs Weight"</span>,</span>
<span id="cb1-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight (1000 lbs)"</span>,</span>
<span id="cb1-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Miles per Gallon"</span>,</span>
<span id="cb1-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figure 1. Scatterplot of fuel efficiency vs car weight using the mtcars dataset."</span></span>
<span id="cb1-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://thesocialsciencesofa.com/blog/2025-06-20/fourth_post_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="slide-in">
<p>This should slide in from below!</p>
</div>


</section>

 ]]></description>
  <category>intro</category>
  <category>welcome</category>
  <guid>https://thesocialsciencesofa.com/blog/2025-06-20/fourth_post.html</guid>
  <pubDate>Thu, 19 Jun 2025 23:00:00 GMT</pubDate>
  <media:content url="https://thesocialsciencesofa.com/blog/2025-06-20/image.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
